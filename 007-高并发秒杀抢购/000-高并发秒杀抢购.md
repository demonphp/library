# 1.高并发下的出现问题
    抢购、秒杀是如今很常见的一个应用场景，主要需要解决的问题有两个：
    1 高并发对数据库产生的压力
    2 竞争状态下如何解决库存的正确减少（"超卖"问题）
    对于第一个问题，已经很容易想到用缓存来处理抢购，避免直接操作数据库，例如使用Redis。重点在于第二个问题

# 2.常规写法
    查询出对应商品的库存，看是否大于0，然后执行生成订单等操作，但是在判断库存是否大于0处，
    如果在高并发下就会有问题，导致库存量出现负数

# 3.优化方案
    1.将库存字段number字段设为unsigned，当库存为0时，因为字段不能为负数，将会返回false
    2.使用MySQL的事务，锁住操作的行
    3.使用非阻塞的文件排他锁
    4.使用redis队列，因为pop操作是原子的，即使有很多用户同时到达，也是依次执行，推荐使用（mysql事务在高并发下性能下降很厉害，文件锁的方式也是）先将商品库存如队列

# 4.并发测试
    模拟5000高并发测试
    webbench -c 100 -t 100 http://www.library.abc/test6.php
    ab -r -n 100 -c 100  http://www.library.abc/test6.php

# 5.其它优化
    如抢购页面做成静态的，通过ajax调用接口
    再如上面的会导致一个用户抢多个，
    思路：
    需要一个排队队列和抢购结果队列及库存队列。高并发情况，先将用户进入排队队列，用一个线程循环处理从排队队
    列取出一个用户，判断用户是否已在抢购结果队列，如果在，则已抢购，否则未抢购，库存减1，写数据库，将用户入结果队列。

# 6.文章参考
    http://blog.csdn.net/nuli888/article/details/51865401

